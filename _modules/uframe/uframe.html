<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>uframe.uframe &mdash; uframe 0.0.25 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5d650c58"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            uframe
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../example.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../uframe.html">uframe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../uframeinstance.html">uframe_instance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generation.html">uframe_from_array_mice()</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generation.html#uframe-from-array-sim">uframe_from_array_sim()</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">uframe</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">uframe.uframe</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for uframe.uframe</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># from src.uframe import uframe_instance</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">.uframe_instance</span> <span class="kn">import</span> <span class="n">uframe_instance</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KernelDensity</span>
<span class="kn">import</span> <span class="nn">sklearn.neighbors</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">MinMaxScaler</span>
<span class="kn">import</span> <span class="nn">miceforest</span> <span class="k">as</span> <span class="nn">mf</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_pdf</span> <span class="kn">import</span> <span class="n">PdfPages</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">compress</span>
<span class="kn">from</span> <span class="nn">.helper</span> <span class="kn">import</span> <span class="n">analysis_table</span><span class="p">,</span> <span class="n">analysis_table_distr</span><span class="p">,</span> <span class="n">plot_pca</span><span class="p">,</span> <span class="n">KL</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span>


<span class="c1"># SOLANGE DAS NICHT FUNKTIONIERT; MÜSSEN WERTE IN KATEGORIELLEN SPALTEN GANZZAHLIG SEIN</span>
<span class="c1"># nur Integer als Keys für kategorielle Verteilung zugelassen, muss append Funktion entsprechend anpassen</span>
<span class="c1"># checke jeweils, ob schon cat value dict vorhanden, falls ja, ob es ergänzt werden muss</span>
<span class="c1"># falls kein cat value dict vorhanden, suche eine cat value Liste, die geeignet ist</span>

<span class="c1"># expected value im kategoriellen Fall und geeignete Anpassung der get dummies Funktionen</span>
<span class="c1"># nach ev darf mit diesme Array einfach kein get dummies with array gecallt werden</span>

<span class="c1"># self cat value dicts muss automatisch erstellt und geupdatet werden, damit ev so funktioniert</span>
<span class="c1"># kann dann auch die OHE Funktionen damit anpassen</span>


<div class="viewcode-block" id="uframe">
<a class="viewcode-back" href="../../uframe.html#uframe.uframe.uframe">[docs]</a>
<span class="k">class</span> <span class="nc">uframe</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for managing uncertain data within a structured framework.</span>

<span class="sd">    This class provides a comprehensive interface for handling data with uncertainties, allowing for operations such as sampling, computing modal and expected values, and one-hot encoding categorical data. It is built around a collection of `uframe_instance` objects, each representing an individual uncertain data instance.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : list</span>
<span class="sd">        A list of `uframe_instance` objects representing the uncertain data points.</span>
<span class="sd">    columns : list</span>
<span class="sd">        List of column names corresponding to the attributes of the data instances.</span>
<span class="sd">    rows : list</span>
<span class="sd">        List of row names, typically representing individual data points or observations.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out: uframe</span>
<span class="sd">        An uframe array object satisfying the specified requirements.</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - The `uframe` class is designed with flexibility in mind, accommodating various types of uncertainty (e.g., probabilistic, intervals) through the `uframe_instance` objects.</span>
<span class="sd">    - It aims to simplify the process of working with uncertain data by providing intuitive methods for common data manipulation and analysis tasks.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; # Assuming uframe_instance objects are already defined as `inst1`, `inst2`, etc.</span>
<span class="sd">    &gt;&gt;&gt; uf = uframe(data=[inst1, inst2], columns=[&#39;Feature1&#39;, &#39;Feature2&#39;], rows=[&#39;Row1&#39;, &#39;Row2&#39;])</span>
<span class="sd">    &gt;&gt;&gt; uf.modal()</span>
<span class="sd">    numpy array of modal values</span>
<span class="sd">    &gt;&gt;&gt; uf.sample(n=10, seed=42)</span>
<span class="sd">    numpy array of samples</span>
<span class="sd">    &gt;&gt;&gt; uf.ev()</span>
<span class="sd">    numpy array of expected values</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="n">new</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rownames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_colnames</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rownames</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">new</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="n">new</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="n">colnames</span><span class="p">,</span> <span class="n">rownames</span><span class="o">=</span><span class="n">rownames</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">analysis_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">true_data</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
                          <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">,</span>
                          <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s2">&quot;changed&quot;</span><span class="p">,</span>
                                          <span class="s2">&quot;changed_mode_MAE&quot;</span><span class="p">,</span> <span class="s2">&quot;changed_mode_RMSE&quot;</span><span class="p">,</span>
                                          <span class="s2">&quot;changed_mode_VAR&quot;</span><span class="p">,</span> <span class="s2">&quot;changed_mode_dif_quantile&quot;</span><span class="p">,</span>
                                          <span class="s2">&quot;overall_mode_MAE&quot;</span><span class="p">,</span> <span class="s2">&quot;overall_mode_RMSE&quot;</span><span class="p">,</span>
                                          <span class="s2">&quot;overall_mode_VAR&quot;</span><span class="p">,</span> <span class="s2">&quot;overall_mode_dif_quantile&quot;</span><span class="p">,</span>
                                          <span class="s2">&quot;changed_ev_MAE&quot;</span><span class="p">,</span> <span class="s2">&quot;changed_ev_RMSE&quot;</span><span class="p">,</span>
                                          <span class="s2">&quot;changed_ev_VAR&quot;</span><span class="p">,</span> <span class="s2">&quot;changed_ev_dif_quantile&quot;</span><span class="p">,</span>
                                          <span class="s2">&quot;overall_ev_MAE&quot;</span><span class="p">,</span> <span class="s2">&quot;overall_ev_RMSE&quot;</span><span class="p">,</span>
                                          <span class="s2">&quot;overall_ev_VAR&quot;</span><span class="p">,</span> <span class="s2">&quot;overall_ev_dif_quantile&quot;</span><span class="p">]))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
            <span class="n">changed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">()[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">true_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>
            <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">changed</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

            <span class="n">tab</span> <span class="o">=</span> <span class="n">analysis_table</span><span class="p">(</span>
                <span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">()[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
            <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tab</span><span class="p">]</span>

            <span class="n">tab</span> <span class="o">=</span> <span class="n">analysis_table</span><span class="p">(</span><span class="n">true_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">()[:,</span> <span class="n">i</span><span class="p">])</span>
            <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tab</span><span class="p">]</span>

            <span class="n">tab</span> <span class="o">=</span> <span class="n">analysis_table</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ev</span><span class="p">()[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
            <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tab</span><span class="p">]</span>

            <span class="n">tab</span> <span class="o">=</span> <span class="n">analysis_table</span><span class="p">(</span><span class="n">true_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ev</span><span class="p">()[:,</span> <span class="n">i</span><span class="p">])</span>
            <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">13</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tab</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">save</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">save</span> <span class="o">=</span> <span class="s1">&#39;analysis_uframe.csv&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">save</span> <span class="o">=</span> <span class="n">save</span> <span class="o">+</span> <span class="s2">&quot;.csv&quot;</span>

            <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">save</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df</span>

<div class="viewcode-block" id="uframe.analysis">
<a class="viewcode-back" href="../../uframe.html#uframe.uframe.uframe.analysis">[docs]</a>
    <span class="k">def</span> <span class="nf">analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">true_data</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform analysis comparing uncertain data instances with its true counterpart.</span>

<span class="sd">        This method generates histograms and statistical tables for continuous variables, comparing the distributions of predicted values (using mode and expected value methods) with true data values. It allows for a detailed examination of how well the uncertain data handling techniques perform and identifies potential biases or discrepancies.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        true_data : np.array</span>
<span class="sd">            The true data values to compare against. This array should have the same shape and order as the data contained within the uframe instance.</span>
<span class="sd">        save : bool or str, default=False</span>
<span class="sd">            If True, the generated plots and tables are saved to a PDF file. If a string is provided, it is used as the filename for the output PDF. If False, the analysis results are simply displayed without saving.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Additional keyword arguments passed to plotting functions, allowing for customization of histograms and other visual elements.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">            This method does not return any value. Its primary output is saved as a pdf file.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - The method internally uses matplotlib and seaborn for generating plots. Ensure these libraries are installed and properly configured in your environment.</span>
<span class="sd">        - If `save` is True or a filename string, the method generates a PDF file containing all the plots and tables produced during the analysis. This file is saved in the current working directory unless a specific path is included in the filename.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; uf = uframe(data=[...])  # Assuming a uframe instance is already created</span>
<span class="sd">        &gt;&gt;&gt; true_data = np.array([...])  # True data values for comparison</span>
<span class="sd">        &gt;&gt;&gt; uf.analysis(true_data, save=&quot;analysis_results&quot;)</span>
<span class="sd">        This example performs the analysis and saves the results to &quot;analysis_results.pdf&quot;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_save</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">save</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">save</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">save</span> <span class="o">=</span> <span class="s1">&#39;analysis_uframe&#39;</span>

            <span class="n">pdf</span> <span class="o">=</span> <span class="n">PdfPages</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">save</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.pdf&#39;</span><span class="p">)</span>
            <span class="n">_save</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Mode analysis</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>
        <span class="n">ev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ev</span><span class="p">()</span>

        <span class="n">cont</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;continuous&#39;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;continuous&#39;</span><span class="p">:</span>
                <span class="c1"># mode</span>
                <span class="n">hist_fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">11.69</span><span class="p">,</span> <span class="mf">8.27</span><span class="p">))</span>

                <span class="n">changed</span> <span class="o">=</span> <span class="n">ev</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="n">true_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

                <span class="c1"># links</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mode, Variable: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mode</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">analysis_table_distr</span><span class="p">(</span>
                    <span class="n">mode</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="s2">&quot;(Mode|True)&quot;</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

                <span class="c1"># rechts</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                    <span class="s1">&#39;True values, Variable:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">analysis_table_distr</span><span class="p">(</span>
                    <span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">mode</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="s2">&quot;(True|Mode)&quot;</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

                <span class="c1"># EV analysis</span>
                <span class="n">changed</span> <span class="o">=</span> <span class="n">ev</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="n">true_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

                <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;EV, Variable:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">analysis_table_distr</span><span class="p">(</span>
                    <span class="n">ev</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="s2">&quot;(EV|True)&quot;</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

                <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                    <span class="s1">&#39;True values, Variable:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">analysis_table_distr</span><span class="p">(</span>
                    <span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">ev</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="s2">&quot;(True|EV)&quot;</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">_save</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">hist_fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>

                <span class="n">hist_fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">11.69</span><span class="p">,</span> <span class="mf">8.27</span><span class="p">))</span>

                <span class="c1"># analysis of variances</span>
                <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                    <span class="s1">&#39;Variances, Variable: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">table</span><span class="p">([[</span><span class="s2">&quot;Mean&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))],</span>
                                 <span class="p">[</span><span class="s2">&quot;Var&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))]],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

                <span class="n">mae_mode_to_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
                    <span class="nb">abs</span><span class="p">(</span><span class="n">mode</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
                <span class="n">mae_ev_to_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
                    <span class="nb">abs</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
                <span class="n">var_to_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span> <span class="o">/</span> \
                    <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>

                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">other_measures</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">table</span><span class="p">([[</span><span class="s2">&quot;Ratios of Variable:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="s2">&quot;&quot;</span><span class="p">],</span>
                                                  <span class="p">[</span><span class="s2">&quot;MAE_EV/mean_true&quot;</span><span class="p">,</span>
                                                      <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mae_ev_to_m</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                                  <span class="p">[</span><span class="s2">&quot;MAE_Mode/mean_true&quot;</span><span class="p">,</span>
                                                      <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mae_mode_to_m</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                                  <span class="p">[</span><span class="s2">&quot;mean_var/mean_true&quot;</span><span class="p">,</span>
                                                      <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">var_to_m</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span>
                                                  <span class="p">[</span><span class="s2">&quot;Uncertain Values/Total&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">changed</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">changed</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">changed</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">changed</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot;%&quot;</span><span class="p">]],</span>
                                                 <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

                <span class="n">other_measures</span><span class="o">.</span><span class="n">auto_set_font_size</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">other_measures</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
                <span class="n">other_measures</span><span class="o">.</span><span class="n">auto_set_column_width</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

                <span class="n">changed</span> <span class="o">=</span> <span class="n">mode</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">true_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>

                <span class="c1"># Residues Mode</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                    <span class="s1">&#39;Residue of Mode, Variable: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mode</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">analysis_table</span><span class="p">(</span>
                    <span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">mode</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

                <span class="c1"># Residues EV</span>
                <span class="n">changed</span> <span class="o">=</span> <span class="n">ev</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">!=</span> <span class="n">true_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                    <span class="s1">&#39;Residue of EV, var:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">residues</span> <span class="o">=</span> <span class="n">ev</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">residues</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">analysis_table</span><span class="p">(</span>
                    <span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">ev</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">_save</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">hist_fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>

                <span class="c1"># Comparison to undeleted data to find potentioal Biases</span>

                <span class="n">hist_fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span>
                    <span class="mf">11.69</span><span class="p">,</span> <span class="mf">8.27</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                axs[0,0].set_title(&#39;EV, Variable: &#39;+ str(self.columns[i]))</span>
<span class="sd">                axs[0,0].hist(ev[changed,i])</span>
<span class="sd">                axs[0,1].set_title(&#39;Mode, Variable: &#39;+ str(self.columns[i]))</span>
<span class="sd">                axs[0,1].hist(mode[changed,i])</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                    <span class="s1">&#39;True Values, ucertain, Variable: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                    <span class="s1">&#39;True Values, certain, Variable: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="o">~</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>

                <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                    <span class="nb">min</span><span class="p">(</span><span class="n">true_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">true_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">30</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                    <span class="s1">&#39;Comparison, certain &amp; uncertain, Variable: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">([</span><span class="n">true_data</span><span class="p">[</span><span class="o">~</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]],</span> <span class="n">bins</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="p">[</span>
                               <span class="s1">&#39;certain instances&#39;</span><span class="p">,</span> <span class="s1">&#39;uncertain instances&#39;</span><span class="p">])</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;5&quot;</span><span class="p">)</span>

                <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">mode</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">bw_adjust</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mode&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">bw_adjust</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;EV&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="o">~</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">bw_adjust</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True certain&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
                <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">bw_adjust</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True uncertain&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
                    <span class="s1">&#39;Comparison of KDE</span><span class="se">\&#39;</span><span class="s1">s &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;5&quot;</span><span class="p">)</span>

                <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ks_statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ks_2samp</span><span class="p">(</span>
                        <span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">true_data</span><span class="p">[</span><span class="o">~</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
                    <span class="n">p_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">ks_statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="s2">&quot;NA&quot;</span><span class="p">,</span> <span class="s2">&quot;NA&quot;</span>

                <span class="n">tab1</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">table</span><span class="p">([[</span><span class="s2">&quot;KS (True Certain | True Uncertain)&quot;</span><span class="p">,</span> <span class="n">p_value</span><span class="p">],</span>
                                        <span class="p">[</span><span class="s2">&quot;KL(True Certain|True Uncertain)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span>
                                            <span class="n">KL</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="o">~</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]))],</span>
                                        <span class="p">[</span><span class="s2">&quot;KL(Mode|True Uncertain)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span>
                                            <span class="n">KL</span><span class="p">(</span><span class="n">mode</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]))],</span>
                                        <span class="p">[</span><span class="s2">&quot;KL(EV|True Uncertain)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">KL</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]))]],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

                <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

                <span class="n">tab1</span><span class="o">.</span><span class="n">auto_set_font_size</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">tab1</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
                <span class="n">tab1</span><span class="o">.</span><span class="n">auto_set_column_width</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

                <span class="n">tab</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">table</span><span class="p">([[</span><span class="s2">&quot;Mean, Mode uncertain&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mode</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="p">[</span><span class="s2">&quot;Mean, EV uncertain&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span>
                                           <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="p">[</span><span class="s2">&quot;Mean, true uncertain &quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span>
                                           <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="p">[</span><span class="s2">&quot;Mean, true certain&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span>
                                           <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="o">~</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="p">[</span><span class="s2">&quot;Mean, true certain &amp; mode uncertain&quot;</span><span class="p">,</span>
                                        <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mode</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="p">[</span><span class="s2">&quot;Mean, true certain &amp; EV uncertain&quot;</span><span class="p">,</span>
                                        <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ev</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))],</span>

                                       <span class="p">[</span><span class="s2">&quot;Var, Mode uncertain&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span>
                                           <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">mode</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="p">[</span><span class="s2">&quot;Var, EV uncertain&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span>
                                           <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="p">[</span><span class="s2">&quot;Var, true uncertain&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span>
                                           <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="p">[</span><span class="s2">&quot;Var, true certain&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span>
                                           <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">true_data</span><span class="p">[</span><span class="o">~</span><span class="n">changed</span><span class="p">,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="p">[</span><span class="s2">&quot;Var, true certain &amp; mode uncertain&quot;</span><span class="p">,</span>
                                        <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">mode</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))],</span>
                                       <span class="p">[</span><span class="s2">&quot;Var, true certain &amp; ev uncertain&quot;</span><span class="p">,</span>
                                        <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">ev</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]),</span> <span class="mi">2</span><span class="p">))]</span>
                                       <span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
                <span class="c1"># axs[3,1].table.auto_set_font_size(False)</span>
                <span class="n">tab</span><span class="o">.</span><span class="n">auto_set_font_size</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">tab</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
                <span class="n">tab</span><span class="o">.</span><span class="n">auto_set_column_width</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">_save</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">hist_fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>

            <span class="c1"># Accuracy in case of categorical</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        if self._col_dtype[i]== &#39;categorical&#39;:</span>
<span class="sd">            hist_fig, hist_ax = plt.subplots(1, 1, figsize=(9, 3))</span>
<span class="sd">            hist_ax.set_title(&#39;Accuracy of Mode, var:&#39;+ str(self._colnames[i]))</span>
<span class="sd">                </span>
<span class="sd">            hist_ax.hist(mode[:,i] == true_data[:,i],**kwargs)</span>
<span class="sd">              </span>
<span class="sd">            if _save == True: </span>
<span class="sd">                hist_fig.savefig(pdf, format = &#39;pdf&#39;)        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s1">&#39;continuous&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="p">:</span>
            <span class="n">colnames</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
                <span class="n">colnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">11.69</span><span class="p">,</span> <span class="mf">8.27</span><span class="p">))</span>

            <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">mode</span><span class="p">[:,</span> <span class="n">cont</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span>
                <span class="n">compress</span><span class="p">(</span><span class="n">colnames</span><span class="p">,</span> <span class="n">cont</span><span class="p">))),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mode Distributions&quot;</span><span class="p">)</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">ev</span><span class="p">[:,</span> <span class="n">cont</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span>
                <span class="n">compress</span><span class="p">(</span><span class="n">colnames</span><span class="p">,</span> <span class="n">cont</span><span class="p">))),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;EV Distributions&quot;</span><span class="p">)</span>

            <span class="n">res_mode</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mode</span> <span class="o">-</span> <span class="n">true_data</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">res_ev</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ev</span> <span class="o">-</span> <span class="n">true_data</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                       <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="n">colnames</span><span class="p">,</span> <span class="n">cont</span><span class="p">))],</span> <span class="n">res_mode</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="n">colnames</span><span class="p">,</span> <span class="n">cont</span><span class="p">)))):</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">res_mode</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">res_mode</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Mode MAE per Variable&quot;</span><span class="p">)</span>

            <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                       <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="n">colnames</span><span class="p">,</span> <span class="n">cont</span><span class="p">))],</span> <span class="n">res_ev</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="n">colnames</span><span class="p">,</span> <span class="n">cont</span><span class="p">)))):</span>
                <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">res_ev</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">res_ev</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;EV MAE per Variable&quot;</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">_save</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>

            <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">11.69</span><span class="p">,</span> <span class="mf">8.27</span><span class="p">))</span>
            <span class="n">dist_mode</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mode</span> <span class="o">-</span> <span class="n">true_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">dist_ev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">ev</span> <span class="o">-</span> <span class="n">true_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dist_mode</span><span class="p">,</span> <span class="n">dist_ev</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
                        <span class="s2">&quot;Mode&quot;</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">]),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Euclidean Distances to true value&quot;</span><span class="p">)</span>

            <span class="n">plot_pca</span><span class="p">(</span><span class="n">true_data</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">uncertain</span><span class="o">=</span><span class="n">changed</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">_save</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">pdf</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>

        <span class="n">pdf</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rownames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">new</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_from_numpy</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">rownames</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_kde</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_from_scipy_kde</span><span class="p">([</span><span class="n">new</span><span class="p">],</span> <span class="n">colnames</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">neighbors</span><span class="o">.</span><span class="n">_kde</span><span class="o">.</span><span class="n">KernelDensity</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_from_sklearn_kde</span><span class="p">([</span><span class="n">new</span><span class="p">],</span> <span class="n">colnames</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">uframe_instance</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_from_uframe_instance</span><span class="p">([</span><span class="n">new</span><span class="p">],</span> <span class="n">colnames</span><span class="p">)</span>

        <span class="c1"># one categorical distribution</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_from_categorical</span><span class="p">([</span><span class="n">new</span><span class="p">],</span> <span class="n">colnames</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new</span><span class="p">),</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new</span><span class="p">),</span>
                                                                            <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_distn_infrastructure</span><span class="o">.</span><span class="n">rv_continuous_frozen</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_from_rv_cont</span><span class="p">([</span><span class="n">new</span><span class="p">],</span> <span class="n">colnames</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new</span><span class="p">),</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_multivariate</span><span class="o">.</span><span class="n">multi_rv_generic</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new</span><span class="p">),</span>
                                                                                             <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_multivariate</span><span class="o">.</span><span class="n">multi_rv_frozen</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_from_rv_cont</span><span class="p">([</span><span class="n">new</span><span class="p">],</span> <span class="n">colnames</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="c1"># try:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append_with_mixed_distributions</span><span class="p">(</span><span class="n">certain</span><span class="o">=</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">continuous</span><span class="o">=</span><span class="n">new</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                                     <span class="n">categorical</span><span class="o">=</span><span class="n">new</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">indices</span><span class="o">=</span><span class="n">new</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="c1"># except BaseException:</span>
                <span class="c1"># raise ValueError(&quot;Unsuitable parameter new given&quot;)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>

                <span class="c1"># check if dict contains continuous or categorical distributions</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">list</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]],</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="nb">list</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">append_with_mixed_categorical</span><span class="p">(</span>
                        <span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">new</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">colnames</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">append_from_mix_with_distr</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">new</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">colnames</span><span class="p">)</span>

            <span class="c1"># one with two lists (or a list of lists of length 2) with only continuous und categorical variables</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_kde</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append_from_scipy_kde</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">colnames</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">neighbors</span><span class="o">.</span><span class="n">_kde</span><span class="o">.</span><span class="n">KernelDensity</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append_from_sklearn_kde</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">colnames</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">uframe_instance</span><span class="p">):</span>
                <span class="c1"># print(&quot;Entered uframe instance list append loop&quot;)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append_from_uframe_instance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">colnames</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_distn_infrastructure</span><span class="o">.</span><span class="n">rv_continuous_frozen</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append_from_rv_cont</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">colnames</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_multivariate</span><span class="o">.</span><span class="n">multi_rv_generic</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                                                                                    <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_multivariate</span><span class="o">.</span><span class="n">multi_rv_frozen</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append_from_rv_cont</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">colnames</span><span class="p">)</span>
            <span class="c1"># Fall, wo Liste von Listen von 1D Distribs übergeben wird</span>
            <span class="c1"># checke, dass hier keine kategorischen Verteilungen übergeben werden</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">append_from_rv_cont</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">colnames</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">append_from_categorical</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">colnames</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown type of new&quot;</span><span class="p">)</span>

        <span class="c1"># sollte evtl. lieber die rownames in jeder append Funktion gesondert adressieren</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addRownames</span><span class="p">([</span><span class="n">new</span><span class="p">],</span> <span class="n">rownames</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addRownames</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rownames</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addRownames</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">rownames</span><span class="p">)</span>

        <span class="k">return</span>

    <span class="c1"># append a numpy array with certain data (2D-array)</span>
    <span class="k">def</span> <span class="nf">append_from_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rownames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">append_with_mixed_distributions</span><span class="p">(</span><span class="n">certain</span><span class="o">=</span><span class="n">new</span><span class="p">,</span> <span class="n">continuous</span><span class="o">=</span><span class="p">{},</span> <span class="n">categorical</span><span class="o">=</span><span class="p">{},</span>
                                             <span class="n">indices</span><span class="o">=</span><span class="p">{},</span> <span class="n">colnames</span><span class="o">=</span><span class="n">colnames</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rownames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="c1"># check rownames for duplicates (also with previously existing rownames)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">+</span> <span class="n">rownames</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">rownames</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Duplicates among rownames&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rownames</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Number of rownames given does not match number of rows given&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">+</span> <span class="n">rownames</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rownames</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span><span class="n">rownames</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rownames</span><span class="p">))})</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">+</span> \
                <span class="p">[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)))]</span>
            <span class="c1"># print(&quot;Rows&quot;, self.rows, &quot;updated with&quot;, [*list(range(len(self.data) - len(new), len(self.data)))])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rownames</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))})</span>

        <span class="k">return</span>

    <span class="c1"># distr list: list of list of dicts (1 list of dicts per instance)</span>
    <span class="k">def</span> <span class="nf">append_from_categorical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distr_list</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="c1"># need correct dimension from first element of distr_list</span>
        <span class="n">dimension</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">distr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">distr_list</span><span class="p">),</span> <span class="n">dimension</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_with_mixed_distributions</span><span class="p">(</span><span class="n">certain</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">continuous</span><span class="o">=</span><span class="p">{},</span>
                                             <span class="n">categorical</span><span class="o">=</span><span class="p">{</span>
                                                 <span class="n">i</span><span class="p">:</span> <span class="n">distr_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">distr_list</span><span class="p">))},</span>
                                             <span class="n">indices</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="p">[[],</span> <span class="p">[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">))]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">distr_list</span><span class="p">))})</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        if len(self.columns) &gt; 0:</span>
<span class="sd">            dimensions = len([len(l) for l in distr_list if len(l) == len(self.columns)])</span>
<span class="sd">            if dimensions != len(distr_list):</span>
<span class="sd">                raise ValueError(&quot;Dimension of list element does not match dimension of uframe&quot;)</span>
<span class="sd">            conts = [i for i in range(len(self.columns)) if self._col_dtype[i] == &#39;continuous&#39;]</span>
<span class="sd">            if len(conts) &gt; 0:</span>
<span class="sd">                raise ValueError(&quot;Categorical distribution in continuous column&quot;)</span>
<span class="sd">        else:</span>
<span class="sd">            dimensions = len([len(l) for l in distr_list if len(l) == len(distr_list[0])])</span>
<span class="sd">            if dimensions != len(distr_list):</span>
<span class="sd">                raise ValueError(&quot;Distributions in list must have same dimension&quot;)</span>

<span class="sd">            if colnames is None:</span>
<span class="sd">                self._columns = [*list(range(len(distr_list[0])))]</span>
<span class="sd">                self._colnames = {i: i for i in range(len(distr_list[0]))}</span>
<span class="sd">            else:</span>
<span class="sd">                if len(colnames) != len(distr_list[0]):</span>
<span class="sd">                    raise ValueError(&quot;Length of column list does not match dim. of distributions&quot;)</span>
<span class="sd">                else:</span>
<span class="sd">                    self._columns = colnames</span>
<span class="sd">                    self._colnames = {name: i for i, name in enumerate(colnames)}</span>
<span class="sd">            self._col_dtype = len(self.columns) * [&#39;categorical&#39;]</span>

<span class="sd">        for i, distr in enumerate(distr_list):</span>
<span class="sd">            self.data.append(uframe_instance(continuous=None, categorical=distr,</span>
<span class="sd">                                             certain_data=None,</span>
<span class="sd">                                             indices=[[], [], [*list(range(len(distr)))]]))</span>

<span class="sd">        return</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">append_from_scipy_kde</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kernel_list</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="n">dimension</span> <span class="o">=</span> <span class="n">kernel_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">d</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">kernel_list</span><span class="p">),</span> <span class="n">dimension</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_with_mixed_distributions</span><span class="p">(</span><span class="n">certain</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">continuous</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">kernel_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kernel_list</span><span class="p">))},</span>
                                             <span class="n">categorical</span><span class="o">=</span><span class="p">{},</span>
                                             <span class="n">indices</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="p">[[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">))],</span> <span class="p">[]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kernel_list</span><span class="p">))})</span>

<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        if len(self.columns) &gt; 0:</span>

<span class="sd">            dimensions = len(</span>
<span class="sd">                [kernel.d for kernel in kernel_list if kernel.d == len(self.columns)])</span>
<span class="sd">            if dimensions != len(kernel_list):</span>
<span class="sd">                raise ValueError(</span>
<span class="sd">                    &quot;Dimension of list element does not match dimension of uframe&quot;)</span>
<span class="sd">            categoricals = [i for i in range(len(self.columns)) if self._col_dtype[i] == &#39;categorical&#39;]</span>
<span class="sd">            if len(categoricals) &gt; 0:</span>
<span class="sd">                raise ValueError(&quot;Continuous kernel in categorical column&quot;)</span>

<span class="sd">        else:</span>
<span class="sd">            # check if all kernels have the same dimension</span>
<span class="sd">            dimensions = len(</span>
<span class="sd">                [kernel.d for kernel in kernel_list if kernel.d == kernel_list[0].d])</span>
<span class="sd">            if dimensions != len(kernel_list):</span>
<span class="sd">                raise ValueError(&quot;Kernels in list must have same dimension&quot;)</span>

<span class="sd">            if colnames is None:</span>
<span class="sd">                self._columns = [*list(range(kernel_list[0].d))]</span>
<span class="sd">                self._colnames = {i: i for i in range(kernel_list[0].d)}</span>
<span class="sd">            else:</span>
<span class="sd">                if len(colnames) != kernel_list[0].d:</span>
<span class="sd">                    raise ValueError(</span>
<span class="sd">                        &quot;Length of column list does not match size of value array&quot;)</span>
<span class="sd">                else:</span>
<span class="sd">                    self._columns = colnames</span>
<span class="sd">                    self._colnames = {name: i for i,</span>
<span class="sd">                                      name in enumerate(colnames)}</span>

<span class="sd">            self._col_dtype = len(self.columns) * [&#39;continuous&#39;]</span>

<span class="sd">        for i, kernel in enumerate(kernel_list):</span>
<span class="sd">            self.data.append(uframe_instance(continuous=kernel, certain_data=None,</span>
<span class="sd">                                             indices=[[], [*list(range(kernel.d))], []]))</span>
<span class="sd">         &#39;&#39;&#39;</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">append_from_sklearn_kde</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kernel_list</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="n">dimension</span> <span class="o">=</span> <span class="n">kernel_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n_features_in_</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">kernel_list</span><span class="p">),</span> <span class="n">dimension</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_with_mixed_distributions</span><span class="p">(</span><span class="n">certain</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">continuous</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">kernel_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kernel_list</span><span class="p">))},</span>
                                             <span class="n">categorical</span><span class="o">=</span><span class="p">{},</span>
                                             <span class="n">indices</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="p">[[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">))],</span> <span class="p">[]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kernel_list</span><span class="p">))})</span>

<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        if len(self.columns) &gt; 0:</span>

<span class="sd">            dimensions = len(</span>
<span class="sd">                [kernel.n_features_in_ for kernel in kernel_list if kernel.n_features_in_ == len(self.columns)])</span>
<span class="sd">            if dimensions != len(kernel_list):</span>
<span class="sd">                raise ValueError(</span>
<span class="sd">                    &quot;Dimension of list element does not match dimension of uframe&quot;)</span>
<span class="sd">            categoricals = [i for i in range(len(self.columns)) if self._col_dtype[i] == &#39;categorical&#39;]</span>
<span class="sd">            if len(categoricals) &gt; 0:</span>
<span class="sd">                raise ValueError(&quot;Continuous kernel in categorical column&quot;)</span>

<span class="sd">        else:</span>
<span class="sd">            # check if all kernels have the same dimension</span>
<span class="sd">            dimensions = len(</span>
<span class="sd">                [kernel.n_features_in_ for kernel in kernel_list if kernel.n_features_in_ == kernel_list[0].d])</span>
<span class="sd">            if dimensions != len(kernel_list):</span>
<span class="sd">                raise ValueError(&quot;Kernels in list must have same dimension&quot;)</span>

<span class="sd">            if colnames is None:</span>
<span class="sd">                self._columns = [*list(range(kernel_list[0].n_features_in_))]</span>
<span class="sd">                self._colnames = {i: i for i in range(</span>
<span class="sd">                    kernel_list[0].n_features_in_)}</span>
<span class="sd">            else:</span>
<span class="sd">                if len(colnames) != kernel_list[0].n_features_in_:</span>
<span class="sd">                    raise ValueError(</span>
<span class="sd">                        &quot;Length of column list does not match size of value array&quot;)</span>
<span class="sd">                else:</span>
<span class="sd">                    self._columns = colnames</span>
<span class="sd">                    self._colnames = {name: i for i,</span>
<span class="sd">                                      name in enumerate(colnames)}</span>
<span class="sd">            self._col_dtype = len(self.columns) * [&#39;continuous&#39;]</span>

<span class="sd">        for i, kernel in enumerate(kernel_list):</span>
<span class="sd">            self.data.append(uframe_instance(continuous=kernel, certain_data=None,</span>
<span class="sd">                                             indices=[[], [*list(range(kernel.n_features_in_))], []]))</span>
<span class="sd">        &#39;&#39;&#39;</span>

    <span class="c1"># jeder Eintrag von distr_list muss entweder eine multivariate Verteilung über alle Variablen</span>
    <span class="c1"># oder eine Liste unabhängiger 1D-Verteilungen</span>
    <span class="k">def</span> <span class="nf">append_from_rv_cont</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distr_list</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="n">distr</span> <span class="o">=</span> <span class="n">distr_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">distr</span><span class="p">),</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_multivariate</span><span class="o">.</span><span class="n">multi_rv_generic</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">distr</span><span class="p">),</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_multivariate</span><span class="o">.</span><span class="n">multi_rv_frozen</span><span class="p">):</span>
            <span class="n">dimension</span> <span class="o">=</span> <span class="n">distr</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">distr</span><span class="p">),</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_distn_infrastructure</span><span class="o">.</span><span class="n">rv_continuous_frozen</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">distr</span><span class="p">),</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">):</span>
            <span class="n">dimension</span> <span class="o">=</span> <span class="n">distr</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">distr</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">dimension</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">d</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">distr</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid argument in distribution list&quot;</span><span class="p">)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">distr_list</span><span class="p">),</span> <span class="n">dimension</span><span class="p">))</span>
        <span class="n">a</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append_with_mixed_distributions</span><span class="p">(</span><span class="n">certain</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
                                             <span class="n">continuous</span><span class="o">=</span><span class="p">{</span>
                                                 <span class="n">i</span><span class="p">:</span> <span class="n">distr_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">distr_list</span><span class="p">))},</span>
                                             <span class="n">categorical</span><span class="o">=</span><span class="p">{},</span>
                                             <span class="n">indices</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="p">[[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">))],</span> <span class="p">[]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">distr_list</span><span class="p">))})</span>

        <span class="k">return</span>

    <span class="c1"># assume dictionary with indices of incomplete lines as keys and scipy kdes as values</span>
    <span class="c1"># nan values for uncertain values in array certain</span>
    <span class="k">def</span> <span class="nf">append_from_mix_with_distr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">certain</span><span class="p">,</span> <span class="n">distr</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">append_with_mixed_distributions</span><span class="p">(</span><span class="n">certain</span><span class="o">=</span><span class="n">certain</span><span class="p">,</span>
                                             <span class="n">continuous</span><span class="o">=</span><span class="n">distr</span><span class="p">,</span>
                                             <span class="n">categorical</span><span class="o">=</span><span class="p">{},</span>
                                             <span class="n">indices</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">[]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">distr</span><span class="o">.</span><span class="n">keys</span><span class="p">()})</span>

        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">append_with_mixed_categorical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">certain</span><span class="p">,</span> <span class="n">distr</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">append_with_mixed_distributions</span><span class="p">(</span><span class="n">certain</span><span class="o">=</span><span class="n">certain</span><span class="p">,</span> <span class="n">continuous</span><span class="o">=</span><span class="p">{},</span>
                                             <span class="n">categorical</span><span class="o">=</span><span class="n">distr</span><span class="p">,</span>
                                             <span class="n">indices</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="p">[[],</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">]))[</span><span class="mi">0</span><span class="p">])]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">distr</span><span class="o">.</span><span class="n">keys</span><span class="p">()})</span>

        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">append_with_mixed_distributions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">certain</span><span class="p">,</span> <span class="n">continuous</span><span class="p">,</span> <span class="n">categorical</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="c1"># certain is an array with missing values indicated by nan values</span>
        <span class="c1"># continuous: dict, keys are indices of lines with missing values, values are MV distr., kernels or lists of 1D distr.</span>
        <span class="c1"># categorical: dict, keys are indices of lines with missing values, values are lists of dicts with categorical distributions for them</span>
        <span class="c1"># indices: dict, keys are indices of lines with missing values, values are lists of 2 lists, first list are indices of missing values with continuous distr, second with categorical</span>
        <span class="c1"># indices have to match the missing values in certain and the dimensions of the continuous and categorical distr.</span>

        <span class="c1"># print(&quot;Indices&quot;, indices)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">!=</span> <span class="n">certain</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dimensions of new data do not match uframe&quot;</span><span class="p">)</span>
            <span class="n">conts</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
                     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;conts&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">conts</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[:,</span> <span class="n">index</span><span class="p">])):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Categorical distribution in continuous column&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">colnames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">certain</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_colnames</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">certain</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colnames</span><span class="p">)</span> <span class="o">!=</span> <span class="n">certain</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Length of column list does not match size of value array&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="n">colnames</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_colnames</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span>
                                      <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">colnames</span><span class="p">)}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[:,</span> <span class="n">col_index</span><span class="p">])):</span>
                <span class="n">categoricals</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">certain</span><span class="p">))</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">col_index</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">categoricals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">conts</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">certain</span><span class="p">))</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">col_index</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">conts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s2">&quot;Continuous and categorical distr in same column&quot;</span><span class="p">)</span>
                        <span class="n">certain_values</span> <span class="o">=</span> <span class="n">certain</span><span class="p">[:,</span> <span class="n">col_index</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span>
                            <span class="n">certain</span><span class="p">[:,</span> <span class="n">col_index</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)]</span>
                        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">certain_values</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">certain_values</span><span class="p">)):</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                <span class="s2">&quot;Float values and categorical distr in same column&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;categorical&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;continuous&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;continuous&#39;</span><span class="p">)</span>

        <span class="c1"># only for continuous case</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">certain</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">continuous</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">categorical</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uframe_instance</span><span class="p">(</span><span class="n">continuous</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                     <span class="n">certain_data</span><span class="o">=</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
                                                     <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span>
                                                              <span class="p">[],</span> <span class="p">[]]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span>
                               <span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">categorical</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uframe_instance</span><span class="p">(</span><span class="n">continuous</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                     <span class="n">categorical</span><span class="o">=</span><span class="n">categorical</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                     <span class="n">certain_data</span><span class="o">=</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span>
                                                         <span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">],</span>
                                                     <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">[],</span>
                                                              <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">]))[</span><span class="mi">0</span><span class="p">])]))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">categorical</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_kde</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">):</span>

                        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span>
                                   <span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">neighbors</span><span class="o">.</span><span class="n">_kde</span><span class="o">.</span><span class="n">KernelDensity</span><span class="p">):</span>

                        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span>
                                   <span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_features_in_</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="n">distr_list</span> <span class="o">=</span> <span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="c1"># check if every list element is rv continuous or rv continuous frozen</span>

                        <span class="k">assert</span> <span class="nb">len</span><span class="p">([</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">distr_list</span> <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">),</span>
                                                                        <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">)</span>
                                    <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">),</span>
                                                  <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_distn_infrastructure</span><span class="o">.</span><span class="n">rv_continuous_frozen</span><span class="p">)])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">distr_list</span><span class="p">)</span>

                        <span class="c1"># check if length of list is correct</span>
                        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span>
                                   <span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                    <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_multivariate</span><span class="o">.</span><span class="n">multi_rv_generic</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                                                                              <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_multivariate</span><span class="o">.</span><span class="n">multi_rv_frozen</span><span class="p">):</span>

                        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span>
                                   <span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

                    <span class="c1"># check if it is 1D distr (one missing attribute in this row)</span>
                    <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                    <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                                                             <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_distn_infrastructure</span><span class="o">.</span><span class="n">rv_continuous_frozen</span><span class="p">):</span>

                        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Distribution type not supported&quot;</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uframe_instance</span><span class="p">(</span><span class="n">continuous</span><span class="o">=</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                     <span class="n">certain_data</span><span class="o">=</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span>
                                                         <span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">],</span>
                                                     <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span>
                                                              <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">[]]))</span>
                <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">categorical</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

                    <span class="c1"># check that the missing value indices and the distributions indices match</span>
                    <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]))[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s2">&quot;Indices of distributions do not match indices of missing values&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_kde</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">):</span>

                        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="o">+</span> <span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">d</span> <span class="o">+</span> \
                            <span class="nb">len</span><span class="p">(</span><span class="n">categorical</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">neighbors</span><span class="o">.</span><span class="n">_kde</span><span class="o">.</span><span class="n">KernelDensity</span><span class="p">):</span>

                        <span class="n">left</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span>
                                   <span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_features_in_</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">categorical</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="n">right</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
                        <span class="k">assert</span> <span class="n">left</span> <span class="o">==</span> <span class="n">right</span>

                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="n">distr_list</span> <span class="o">=</span> <span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

                        <span class="k">assert</span> <span class="nb">len</span><span class="p">([</span><span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">distr_list</span> <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">),</span>
                                                                        <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">)</span>
                                    <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">),</span>
                                                  <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_distn_infrastructure</span><span class="o">.</span><span class="n">rv_continuous_frozen</span><span class="p">)])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">distr_list</span><span class="p">)</span>

                        <span class="c1"># check if length of list is correct</span>
                        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span>
                            <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
                        <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> \
                            <span class="nb">len</span><span class="p">(</span><span class="n">categorical</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

                    <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                    <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_multivariate</span><span class="o">.</span><span class="n">multi_rv_generic</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                                                                              <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_multivariate</span><span class="o">.</span><span class="n">multi_rv_frozen</span><span class="p">):</span>

                        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span>
                            <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
                        <span class="o">+</span> <span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> \
                            <span class="nb">len</span><span class="p">(</span><span class="n">categorical</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

                    <span class="k">elif</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                    <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                                                                             <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">_distn_infrastructure</span><span class="o">.</span><span class="n">rv_continuous_frozen</span><span class="p">):</span>

                        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span>
                                   <span class="mi">0</span><span class="p">]))</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">categorical</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Distribution type not supported&quot;</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uframe_instance</span><span class="p">(</span><span class="n">continuous</span><span class="o">=</span><span class="n">continuous</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                     <span class="n">categorical</span><span class="o">=</span><span class="n">categorical</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                                                     <span class="n">certain_data</span><span class="o">=</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span>
                                                         <span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">],</span>
                                                     <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">certain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span>
                                                              <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]))</span>

        <span class="k">return</span>

    <span class="c1"># append from a list of uframe_instance objects</span>
    <span class="k">def</span> <span class="nf">append_from_uframe_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instances</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">dimensions</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
                <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span> <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)])</span>
            <span class="k">if</span> <span class="n">dimensions</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Dimensions of new instances do not match dimension of uframe&quot;</span><span class="p">)</span>
            <span class="n">categoricals</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;categorical&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">categoricals</span><span class="p">:</span>
                <span class="c1"># check if that index is continuous or a certain float value in any of the new uframe_instances</span>
                <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s2">&quot;Continuous distribution in categorical column&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">certain_value</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">certain_data</span><span class="p">[</span><span class="n">instance</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                            <span class="n">index</span><span class="p">)]</span>
                        <span class="k">if</span> <span class="n">certain_value</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">certain_value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                <span class="s2">&quot;Float value in categorical column&quot;</span><span class="p">)</span>

        <span class="c1"># treat colnames parameter here in else case</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">colnames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">])))]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_colnames</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]))}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">colnames</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Length of column list does not match size of value array&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="n">colnames</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_colnames</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span>
                                      <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">colnames</span><span class="p">)}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="s1">&#39;continuous&#39;</span><span class="p">]</span>

        <span class="c1"># print(&quot;Data&quot;, self.data)</span>
        <span class="c1"># print(&quot;Instances&quot;, instances)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="n">instances</span>
        <span class="c1"># print(&quot;After appending&quot;, self.data)</span>

        <span class="k">return</span>

    <span class="c1"># samples: list of length (n_instances) of np.ndarray of shape (dim_samples, n_samples) oder listen von np.arrays (dim_samples,)</span>
    <span class="c1"># erstellt kernels und greift auf bereits existierende append-Funktion zurück</span>
    <span class="c1"># für scipy Gaussian und alle sklearn Kernels</span>
    <span class="k">def</span> <span class="nf">append_from_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples_list</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;stats.gaussian_kde&#39;</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rownames</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No samples given&quot;</span><span class="p">)</span>

        <span class="n">kernel_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">samples</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">samples_list</span><span class="p">):</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

            <span class="k">if</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s1">&#39;stats.gaussian_kde&#39;</span><span class="p">:</span>
                <span class="n">kde</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kernel</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;tophat&#39;</span><span class="p">,</span> <span class="s1">&#39;epanechnikov&#39;</span><span class="p">,</span> <span class="s1">&#39;exponential&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;cosine&#39;</span><span class="p">]:</span>
                <span class="n">samples</span> <span class="o">=</span> <span class="n">samples</span><span class="o">.</span><span class="n">T</span>
                <span class="n">kde</span> <span class="o">=</span> <span class="n">KernelDensity</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Given kernel does not exist&quot;</span><span class="p">)</span>
            <span class="n">kernel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kde</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s1">&#39;stats.gaussian_kde&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_from_scipy_kde</span><span class="p">(</span><span class="n">kernel_list</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="n">colnames</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append_from_sklearn_kde</span><span class="p">(</span><span class="n">kernel_list</span><span class="p">,</span> <span class="n">colnames</span><span class="o">=</span><span class="n">colnames</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">addRownames</span><span class="p">(</span><span class="n">kernel_list</span><span class="p">,</span> <span class="n">rownames</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">addRownames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="n">rownames</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">rownames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="c1"># check rownames for duplicates (also with previously existing rownames)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">+</span> <span class="n">rownames</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">rownames</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Duplicates among rownames&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rownames</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Number of rownames given does not match number of rows given&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">+</span> <span class="n">rownames</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rownames</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">{</span><span class="n">rownames</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rownames</span><span class="p">))})</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">+</span> \
                <span class="p">[</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)))]</span>
            <span class="c1"># print(&quot;Rows&quot;, self.rows, &quot;updated with&quot;, [*list(range(len(self.data) - len(new), len(self.data)))])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rownames</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))})</span>

        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="s2">&quot;Object of class uframe&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Object of class uframe with certain values:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_rep</span><span class="p">())</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">indices_uncertain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inst</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
        <span class="n">uncertain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">uncertain</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="n">uncertain</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">array_rep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">instance</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
            <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">certain_data</span>
            <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">instance</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="k">return</span> <span class="n">x</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>

    <span class="nd">@shape</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Can&#39;t manually set shape&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span>

    <span class="nd">@columns</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_columns</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_columns</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Length of new column list does not match column number of uframe&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">new_columns</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_columns</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;New column list contains duplicates!&quot;</span><span class="p">)</span>

        <span class="c1"># update _colnames dictionary if it is not empty</span>

        <span class="n">new_d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">new_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_columns</span><span class="p">):</span>

            <span class="n">new_d</span><span class="p">[</span><span class="n">new_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_colnames</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_colnames</span> <span class="o">=</span> <span class="n">new_d</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_columns</span> <span class="o">=</span> <span class="n">new_columns</span>
        <span class="k">return</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span>

    <span class="c1"># rows always have to be integers so far, probably keep it that way like pandas</span>
    <span class="nd">@rows</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_rows</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Length of new row list does not match row number of uframe&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">new_rows</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;New row list contains duplicates&quot;</span><span class="p">)</span>

        <span class="c1"># check that all row indices are integers</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">([</span><span class="n">index</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">new_rows</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">int</span><span class="p">)])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Indices of rows have to be integers&quot;</span><span class="p">)</span>

        <span class="n">new_d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">new_index</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_rows</span><span class="p">):</span>

            <span class="n">new_d</span><span class="p">[</span><span class="n">new_index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rownames</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rownames</span> <span class="o">=</span> <span class="n">new_d</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span> <span class="o">=</span> <span class="n">new_rows</span>

        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">get_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rownames</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">col_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># könnte das hier ändern, sodass es die Reihenfolge gemäß self.columns zurückgibt</span>
        <span class="c1"># noch nicht relevant, aber falls Ändern der Spaltenreihenfolge später möglich ist</span>
        <span class="c1"># nutze dafür dann self._colnames für Zuordnungen</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span>

    <span class="c1"># set type of a column, if new type matches the values and distributions in that column</span>
    <span class="c1"># not tested yet</span>
    <span class="k">def</span> <span class="nf">set_col_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">col_dtype</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">col_dtype</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;continuous&#39;</span><span class="p">,</span> <span class="s1">&#39;categorical&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid col_dtype&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">column</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_colnames</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Column does not exist&quot;</span><span class="p">)</span>

        <span class="n">col_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_colnames</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="p">[</span><span class="n">col_index</span><span class="p">]</span> <span class="o">==</span> <span class="n">col_dtype</span><span class="p">:</span>
            <span class="c1"># print(&quot;Column already has desired col_dtype&quot;)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">col_dtype</span> <span class="o">==</span> <span class="s1">&#39;continuous&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">col_index</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Categorical distributions in this column, cannot make it continuous&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">col_dtype</span> <span class="o">==</span> <span class="s1">&#39;categorical&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">col_index</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Continuous distributions in this column, cannot make it categorical&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">col_index</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">certain_value</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">certain_data</span><span class="p">[</span><span class="n">instance</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                        <span class="n">col_index</span><span class="p">)]</span>
                    <span class="k">if</span> <span class="n">certain_value</span> <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">certain_value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s2">&quot;Float value in column, cannot make it categorical&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="p">[</span><span class="n">col_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">col_dtype</span>

        <span class="k">return</span>

    <span class="c1"># function for reordering columns and rows</span>
    <span class="c1"># Parameter: Liste mit Teilmenge der Spalten in einer bestimmten Reihenfolge, interpretiere das als</span>
    <span class="c1"># neue Reihenfolge dieser Spalten, i.e., wenn bei Spalten [1,2,4] der Parameter [4,2,1] übergeben wird,</span>
    <span class="c1"># werden diese 3 Spalten so neu angeordnet, der Rest bleibt unverändert</span>
    <span class="c1"># dies wird nur für die Ausgabe in columns gespeichert (passe dann array_rep Funktion entsprechend an)</span>
    <span class="c1"># Frage: wird dann auf Input für append Funktionen entsprechend eingegangen und gemäß</span>
    <span class="c1"># _colnames vertauscht vor dem Speichern? Müsste aus Gründen der Benutzerfreundlichkeit eigentlich so passieren</span>
    <span class="c1"># würde in den append-Funktionen einem geeigneten Umsortieren gemäß self._colnames entsprechen</span>
    <span class="c1"># noch zu besprechen</span>
    <span class="k">def</span> <span class="nf">reorder_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

<div class="viewcode-block" id="uframe.mode">
<a class="viewcode-back" href="../../uframe.html#uframe.uframe.uframe.mode">[docs]</a>
    <span class="k">def</span> <span class="nf">mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the modal values for all uncertain data instances within the uframe.</span>

<span class="sd">        This method iterates over each `uframe_instance` contained in the `uframe` and computes their modal values. The modal value is considered the most likely value for each uncertain instance, providing a deterministic approximation of the data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Additional keyword arguments that are passed to the `mode` method of each `uframe_instance`. These arguments can be used to customize the computation of modal values for individual instances.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.array</span>
<span class="sd">            A numpy array containing the modal values for all data instances within the uframe. The array is structured such that each row corresponds to the modal values of a single `uframe_instance`.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - This method relies on the `mode` method of the `uframe_instance` class, which must be capable of computing modal values for a given instance of uncertain data.</span>
<span class="sd">        - The returned array provides a convenient, deterministic representation of the uncertain data, suitable for visualization, analysis, or further statistical processing.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; uf = uframe(data=[...])  # Assuming a uframe object is already created with uncertain data instances</span>
<span class="sd">        &gt;&gt;&gt; modal_values = uf.mode()</span>
<span class="sd">        This example computes the modal values for all uncertain data instances within the uframe and stores the result in `modal_values`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>


<div class="viewcode-block" id="uframe.var">
<a class="viewcode-back" href="../../uframe.html#uframe.uframe.uframe.var">[docs]</a>
    <span class="k">def</span> <span class="nf">var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the variance for all uncertain data instances in the uframe.</span>

<span class="sd">        This method aggregates the variances of each uncertain data instance (`uframe_instance`) within the `uframe`. It is particularly useful for understanding the spread or dispersion of the uncertainty across the data instances.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n : int, default=50</span>
<span class="sd">            The number of samples to generate for each uncertain data instance to estimate their variance. Increasing this number can improve the accuracy of the variance estimation but also increases computational load.</span>
<span class="sd">        seed : Optional[int], default=None</span>
<span class="sd">            Seed for the random number generator to ensure reproducibility of the computation. If None, the randomness is unpredictable and the results may vary on each call.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.array</span>
<span class="sd">            A numpy array containing the variance values for all uncertain data instances within the uframe. Each element in the array corresponds to the variance of an individual `uframe_instance`.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - This method provides a measure of the uncertainty&#39;s variability and can be a critical component of risk assessment and decision-making processes.</span>
<span class="sd">        - The calculation is based on sampling from the uncertain distributions of each data instance, hence the importance of the `n` parameter for controlling the trade-off between computational efficiency and estimation accuracy.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; uf = uframe(data=[...])  # Assuming a uframe object is already created with uncertain data instances</span>
<span class="sd">        &gt;&gt;&gt; variances = uf.var(n=100, seed=42)</span>
<span class="sd">        This example computes the variances for all uncertain data instances within the uframe, using 100 samples for the estimation and a seed for reproducibility, and stores the result in `variances`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span> <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">])</span></div>


<div class="viewcode-block" id="uframe.sample">
<a class="viewcode-back" href="../../uframe.html#uframe.uframe.uframe.sample">[docs]</a>
    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate samples from each uncertain data instance in the uframe.</span>

<span class="sd">        This method iterates over each `uframe_instance` contained in the `uframe`, generating a specified number of samples from each. These samples can be used for stochastic simulation, uncertainty propagation analysis, or further statistical processing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n : int, default=1</span>
<span class="sd">            The number of samples to generate for each uncertain data instance. Specifies how many samples are drawn to represent the uncertainty of each instance.</span>
<span class="sd">        seed : Optional[int], default=None</span>
<span class="sd">            Seed for the random number generator to ensure reproducibility of the generated samples. If None, the sampling process is stochastic and may yield different results on each call.</span>
<span class="sd">        threshold : int, default=1</span>
<span class="sd">            A threshold parameter that could potentially be used to control the sampling process or filter the generated samples based on certain criteria. The implementation details and usage of this parameter may vary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.array</span>
<span class="sd">            A numpy array containing the generated samples for all data instances within the `uframe`. The array is structured such that each row corresponds to a set of samples from a single `uframe_instance`.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - The generation of samples is a fundamental aspect of working with uncertain data, allowing for the exploration of possible outcomes and the assessment of variability within the data.</span>
<span class="sd">        - The `seed` parameter plays a crucial role in ensuring that the sampling process can be replicated, which is vital for experiments that require consistency across runs.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; uf = uframe(data=[...])  # Assuming a `uframe` object is already created with uncertain data instances</span>
<span class="sd">        &gt;&gt;&gt; samples = uf.sample(n=10, seed=42)</span>
<span class="sd">        This example generates 10 samples for each uncertain data instance within the `uframe`, using a seed for reproducibility, and stores the result in `samples`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span> <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>


<div class="viewcode-block" id="uframe.ev">
<a class="viewcode-back" href="../../uframe.html#uframe.uframe.uframe.ev">[docs]</a>
    <span class="k">def</span> <span class="nf">ev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the expected values for all uncertain data instances in the uframe.</span>

<span class="sd">        This method iterates over each `uframe_instance` contained in the `uframe` and computes their expected values, typically the mean of the uncertain distribution. For instances with categorical data, the expected value for categorical variables is handled separately.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n : Optional[int], default=None</span>
<span class="sd">            The number of samples to generate for estimating the expected value. A higher number may improve the accuracy of the estimation for continuous distributions. If None, a default value based on the number of columns is used.</span>
<span class="sd">        seed : Optional[int], default=None</span>
<span class="sd">            Seed for the random number generator to ensure reproducibility of the results. If None, the randomness is unpredictable.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.array</span>
<span class="sd">            A numpy array containing the expected values for all data instances within the uframe. For instances without categorical data, this is a straightforward array of means. For instances with categorical data, the method handles these separately and integrates them into the returned array where applicable.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - The expected value calculation is particularly useful for providing a deterministic approximation of uncertain data, which can be beneficial for analysis, visualization, and further statistical processing.</span>
<span class="sd">        - The handling of categorical data involves specific treatment due to the nature of categorical distributions, which may not have a direct notion of &#39;mean&#39; in the traditional sense.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; uf = uframe(data=[...])  # Assuming a uframe object is already created with uncertain data instances</span>
<span class="sd">        &gt;&gt;&gt; expected_values = uf.ev(n=100, seed=42)</span>
<span class="sd">        This example calculates the expected values for all uncertain data instances within the uframe, using 100 samples for estimation and a seed for reproducibility, and stores the result in `expected_values`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">evs</span> <span class="o">=</span> <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">ev</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span> <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;categorical&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="p">:</span>

            <span class="c1"># print([(ev, type(ev)) for ev in evs])</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">ev</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ev</span><span class="p">)))</span> <span class="k">for</span> <span class="n">ev</span> <span class="ow">in</span> <span class="n">evs</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># print(&quot;Evs&quot;, evs)</span>

            <span class="c1"># conts = [ev[0].shape for ev in evs]</span>
            <span class="n">cats</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">conts</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ev</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">evs</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ev</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="n">cats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">conts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cats</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="n">conts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ev</span><span class="p">)</span>

           <span class="c1"># print(&quot;Length of cats&quot;, len(cats), cats)</span>

            <span class="c1"># print(&quot;Ev 0 list&quot;, [ev[0] for ev in evs])</span>
            <span class="c1"># print([ev[0].shape for ev in evs])</span>
            <span class="c1"># print(&quot;Conts&quot;, conts)</span>
            <span class="c1"># print([cont.shape for cont in conts])</span>
            <span class="n">conts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">cont</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cont</span><span class="p">)))</span>
                                   <span class="k">for</span> <span class="n">cont</span> <span class="ow">in</span> <span class="n">conts</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1"># print(&quot;Conts&quot;, conts, conts.shape)</span>
            <span class="n">ohes</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;categorical&#39;</span><span class="p">:</span>

                    <span class="c1"># have some known values in conts as well as nan values</span>

                    <span class="c1"># have to iterate over lines</span>
                    <span class="c1"># know all levels of this variable from cat value dict</span>
                    <span class="c1"># need to make sure it exists</span>
                    <span class="n">levels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cat_value_dicts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">conts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)))</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">conts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="c1"># print(&quot;i&quot;, i, &quot;j&quot;, j, &quot;Indices&quot;, self.data[j].indices)</span>
                        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">conts</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]):</span>
                            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                            <span class="c1"># print(&quot;I&quot;, i, &quot;j&quot;, j, &quot;Index&quot;, index)</span>
                            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cats</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                                <span class="c1"># print(&quot;Cat value dict for column i&quot;, self.cat_value_dicts[i])</span>
                                <span class="c1"># print(&quot;Key&quot;, key)</span>
                                <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cat_value_dicts</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">key</span><span class="p">])</span>
                                  <span class="p">]</span> <span class="o">=</span> <span class="n">cats</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">index</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">conts</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])]</span> <span class="o">=</span> <span class="mi">1</span>

                    <span class="n">ohes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span>
                    <span class="c1"># print(&quot;Shape of ohes i&quot;, ohes[i].shape)</span>

                <span class="c1"># get new array from conts and the m arrays in ohes</span>
            <span class="n">ev_array</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
                <span class="c1"># print(&quot;i&quot;, i)</span>
                <span class="k">if</span> <span class="n">ev_array</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;categorical&#39;</span><span class="p">:</span>
                        <span class="n">ev_array</span> <span class="o">=</span> <span class="n">ohes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ev_array</span> <span class="o">=</span> <span class="n">conts</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">conts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;categorical&#39;</span><span class="p">:</span>
                        <span class="n">ev_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">ev_array</span><span class="p">,</span> <span class="n">ohes</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ev_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                            <span class="p">(</span><span class="n">ev_array</span><span class="p">,</span> <span class="n">conts</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">conts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">ev_array</span></div>


    <span class="c1"># performs One Hot Encoding of categorical columns after filling uncertain values by sampling/ mode/ ev</span>
    <span class="c1"># return columns in some way?</span>

<div class="viewcode-block" id="uframe.get_dummies">
<a class="viewcode-back" href="../../uframe.html#uframe.uframe.uframe.get_dummies">[docs]</a>
    <span class="k">def</span> <span class="nf">get_dummies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span> <span class="n">samples_per_distrib</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform one-hot encoding on all categorical columns in the uframe data.</span>

<span class="sd">        This method identifies categorical variables within the `uframe` and transforms them into a one-hot encoded format. One-hot encoding is a process that converts categorical variables into a form that could be provided to ML algorithms to do a better job in prediction.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        uframe</span>
<span class="sd">            A new `uframe` instance where all categorical columns have been replaced with their one-hot encoded representations. The transformation is applied across all `uframe_instance` objects contained within the original `uframe`, ensuring that the structure of the data is maintained while categorical variables are appropriately encoded.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - The method ensures that the original `uframe` object remains unchanged, providing a transformed copy as its return value. This behavior supports immutability and functional programming paradigms.</span>
<span class="sd">        - One-hot encoding expands the dimensionality of the data, where each unique category value in a column is transformed into a new binary column (1s and 0s), indicating the presence of the category.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; uf = uframe(data=[...])  # Assuming a `uframe` object is already created with uncertain data instances, including categorical data</span>
<span class="sd">        &gt;&gt;&gt; uf_encoded = uf.get_dummies()</span>
<span class="sd">        This example transforms the categorical variables within the `uframe` into a one-hot encoded format, facilitating their use in machine learning models and other analytical methods that require numerical input.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># do sampling, ev, modal</span>
        <span class="c1"># then iterate over the columns and for categorical</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;sample&#39;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">samples_per_distrib</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;mode&#39;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;ev&#39;</span><span class="p">:</span>
            <span class="c1"># expected value already incorporates ohe in categorical case</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ev</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need method for treating uncertain values&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dummies_for_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>


    <span class="c1"># gets dummies for given array x, which has to match the column number, no extra method there</span>
    <span class="k">def</span> <span class="nf">get_dummies_for_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>

        <span class="n">x_ohe</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;categorical&#39;</span><span class="p">:</span>

                <span class="n">integer_encoded</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>

                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;cat_values&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cat_values</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cat_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">categories</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">categories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">certain_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                    <span class="k">elif</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>

                        <span class="n">categories</span> <span class="o">=</span> <span class="n">categories</span> <span class="o">+</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">categorical</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

                <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">categories</span><span class="p">)))]</span>

                <span class="c1"># print(&quot;Categories&quot;, categories)</span>
                <span class="n">onehot_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span>
                    <span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">)</span>
                <span class="n">integer_encoded</span> <span class="o">=</span> <span class="n">integer_encoded</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">integer_encoded</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">onehot_encoded</span> <span class="o">=</span> <span class="n">onehot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">integer_encoded</span><span class="p">)</span>

                <span class="c1"># print(&quot;One hot encoded shape&quot;, onehot_encoded.shape)</span>
                <span class="k">if</span> <span class="n">x_ohe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">x_ohe</span> <span class="o">=</span> <span class="n">onehot_encoded</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x_ohe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x_ohe</span><span class="p">,</span> <span class="n">onehot_encoded</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">x_ohe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">x_ohe</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x_ohe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">x_ohe</span><span class="p">,</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="p">))),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">x_ohe</span>

    <span class="k">def</span> <span class="nf">make_cat_value_dicts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cat_value_dicts</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>

            <span class="c1"># print(&quot;I&quot;, i)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_col_dtype</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;categorical&#39;</span><span class="p">:</span>

                <span class="c1"># check if self has a cat values attribute</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;cat_values&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cat_values</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">categories</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cat_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">categories</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">categories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">certain_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)])</span>
                    <span class="k">elif</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>

                        <span class="n">categories</span> <span class="o">=</span> <span class="n">categories</span> <span class="o">+</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">categorical</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

                <span class="n">categories</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">categories</span><span class="p">))</span>
                <span class="c1"># print(&quot;Categories&quot;, categories)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cat_value_dicts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">categories</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">))}</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cat_value_dicts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span>

    <span class="c1"># new stuff as parameter: do not think so, would have to find out what new uframe instances are there</span>
    <span class="k">def</span> <span class="nf">update_cat_value_dicts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># check for each categorical column if all its values are already in the cat value dict</span>
        <span class="c1"># if not, append new keys with them and give them the correct index</span>

        <span class="k">return</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">==</span> <span class="nb">slice</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">uframe</span><span class="p">(</span>
                <span class="n">new</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">colnames</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">,</span> <span class="n">rownames</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="n">uframe</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">],</span> <span class="n">colnames</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_columns</span><span class="p">,</span> <span class="n">rownames</span><span class="o">=</span><span class="p">[</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">_rows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">_mode_calculated</span><span class="p">():</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">_set_mode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">mode</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">add_cat_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cat_value_dict</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;cat_values&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cat_values</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cat_value_dict</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cat_values</span> <span class="o">=</span> <span class="n">cat_value_dict</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_cat_value_dicts</span><span class="p">()</span>

        <span class="k">return</span>

<div class="viewcode-block" id="uframe.ML">
<a class="viewcode-back" href="../../uframe.html#uframe.uframe.uframe.ML">[docs]</a>
    <span class="k">def</span> <span class="nf">ML</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform maximum likelihood estimation (MLE) based on given points and observed outcomes.</span>

<span class="sd">        This method applies the principle of maximum likelihood estimation to estimate the parameters of a probability distribution that make the observed data (categorized by &#39;y&#39;) most likely. It calculates the likelihood of each point belonging to different categories based on the probability density function (PDF) values across all uncertain data instances within the `uframe`. The goal is to find the parameter values that maximize the likelihood function, indicating the most probable parameters given the observed data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        points : np.array</span>
<span class="sd">            An array of points for which the likelihood of belonging to each category defined by &#39;y&#39; is to be estimated. The dimensionality of &#39;points&#39; should match that of the data within the `uframe`.</span>
<span class="sd">        y : np.array</span>
<span class="sd">            An array of observed outcomes or categories for the given points. Each element in &#39;y&#39; corresponds to a category label for the point at the same index in &#39;points&#39;.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            A dictionary where keys are the unique values of &#39;y&#39; (category labels) and values are arrays representing the estimated likelihood of each point belonging to the corresponding category. This probabilistic classification is based on the maximum likelihood principle.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - Maximum Likelihood Estimation (MLE) is a statistical method used for estimating the parameters of a probability distribution or statistical model. The principle behind MLE is to choose the parameter values that maximize the likelihood function, which measures the probability of observing the given sample data under different parameter values of the model.</span>
<span class="sd">        - MLE is fundamental in statistical inference, providing estimators that converge to the true parameter values as the sample size increases (consistency) and achieve the lowest possible variance among all estimators in large samples (efficiency).</span>
<span class="sd">        - This method leverages the PDF values computed for the uncertain data instances, using these to assess the likelihood of each observed outcome, making it a powerful tool for classification and analysis in the presence of uncertainty.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; uf = uframe(data=[...])  # Assuming a `uframe` object is already created</span>
<span class="sd">        &gt;&gt;&gt; points = np.array([[1, 2], [3, 4], [5, 6]])  # Example points for classification</span>
<span class="sd">        &gt;&gt;&gt; y = np.array([0, 1, 0])  # Observed categories for the points</span>
<span class="sd">        &gt;&gt;&gt; likelihoods = uf.ML(points, y)</span>
<span class="sd">        This example performs maximum likelihood estimation to classify each point into categories, based on the observed data and the uncertain model represented by the `uframe`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wrong Dimension of given points&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wrong count of y values&quot;</span><span class="p">)</span>

        <span class="n">pdfs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">pdfs</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="n">y_value</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">y_value</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>

        <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">y_value</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
            <span class="n">dic</span><span class="p">[</span><span class="n">y_value</span><span class="p">]</span> <span class="o">=</span> <span class="n">pdfs</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="n">y_value</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">s</span> <span class="o">+=</span> <span class="n">dic</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dic</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">/</span><span class="n">s</span>

        <span class="k">return</span> <span class="n">dic</span></div>


<div class="viewcode-block" id="uframe.cdf">
<a class="viewcode-back" href="../../uframe.html#uframe.uframe.uframe.cdf">[docs]</a>
    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the cumulative distribution function (CDF) for the given input(x) for all instances in the data frame.</span>

<span class="sd">        This method calculates the PDF values for each input in &#39;x&#39; considering only continuous uncertainties within the instance. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : np.array | List</span>
<span class="sd">            The input value(s) for which the CDF values should be computed. Can be a list or a numpy array. The input should match the structure and dimensions of the uncertain data instance, i.e., it should have the same number of elements as there are uncertain and certain variables in the instance.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.array</span>
<span class="sd">            An array of CDF values corresponding to each input in &#39;x&#39;.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - The method automatically handles inputs in list format by converting them to numpy arrays.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; u_instance = uframe_instance(certain_data=np.array([1, 2, 3]),</span>
<span class="sd">                                         continuous=scipy.stats.norm(loc=0, scale=1))</span>
<span class="sd">        &gt;&gt;&gt; u_instance.cdf([0, 1, 2, 1])</span>
<span class="sd">        array([[PDF value]])</span>

<span class="sd">        &gt;&gt;&gt; u_instance.pdf(np.array([[0, 1, 2], [3, 4, 5]]))</span>
<span class="sd">        array([[PDF value for [0, 1, 2]],</span>
<span class="sd">               [PDF value for [3, 4, 5]]])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))]</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">arr</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">ret</span></div>


<div class="viewcode-block" id="uframe.pdf">
<a class="viewcode-back" href="../../uframe.html#uframe.uframe.uframe.pdf">[docs]</a>
    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the probability density function (PDF) for given points across all uncertain data instances.</span>

<span class="sd">        This method computes the PDF values for a set of given points, evaluating the likelihood of each point under the uncertainty distributions represented by the `uframe_instance` objects within the `uframe`. It&#39;s particularly useful for statistical analysis and understanding the distribution of uncertain data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        points : np.array or list</span>
<span class="sd">            An array or list of points for which the PDF values are to be computed. The points should match the dimensionality and structure of the uncertain data instances within the `uframe`. If provided as a list, it will be converted into a numpy array for processing.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.array</span>
<span class="sd">            An array of PDF values corresponding to the input points. The array&#39;s shape will depend on the number of points and the structure of the `uframe` data. Each value represents the likelihood of the corresponding point under the distributions encapsulated by the `uframe`.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - The method supports vectorized operations, allowing for efficient computation of PDF values for multiple points simultaneously.</span>
<span class="sd">        - For uncertain data instances with multiple dimensions, the points should be provided in a compatible format that matches these dimensions.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; uf = uframe(data=[...])  # Assuming a `uframe` object is already created with uncertain data instances</span>
<span class="sd">        &gt;&gt;&gt; points = np.array([[1, 2], [3, 4]])  # Points for which PDF values are needed</span>
<span class="sd">        &gt;&gt;&gt; pdf_values = uf.pdf(points)</span>
<span class="sd">        This example calculates the PDF values for the specified points across all uncertain data instances within the `uframe`, illustrating how to assess the likelihood of these points.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))]</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">arr</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">ret</span></div>


<div class="viewcode-block" id="uframe.save">
<a class="viewcode-back" href="../../uframe.html#uframe.uframe.uframe.save">[docs]</a>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;saved_uframe.pkl&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Serialize and save the current state of the uframe object to a file.</span>

<span class="sd">        This method allows for the persistence of the `uframe` object, including all its data and configurations, by saving it to a specified file. The saved file can later be reloaded to restore the `uframe` object to its saved state, facilitating use cases like model checkpointing, data sharing, or analysis continuation at a later time.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str, default=&#39;saved_uframe.pkl&#39;</span>
<span class="sd">            The name of the file to which the `uframe` object will be saved. If not specified, the default filename &#39;saved_uframe.pkl&#39; is used. It is recommended to use the &#39;.pkl&#39; extension to indicate that the file is a pickle file.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - The method uses Python&#39;s pickle module for serialization, which is efficient but not secure against erroneous or maliciously constructed data. Never unpickle data received from an untrusted or unauthenticated source.</span>
<span class="sd">        - It is advisable to specify an absolute path for the `name` parameter if you want to save the file to a specific directory.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; uf = uframe(data=[...])  # Assuming a `uframe` object is already created</span>
<span class="sd">        &gt;&gt;&gt; uf.save(name=&#39;my_uframe_data.pkl&#39;)</span>
<span class="sd">        This example saves the `uframe` object to a file named &#39;my_uframe_data.pkl&#39;, allowing it to be easily reloaded in future sessions for further use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="kc">None</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">certain_data</span><span class="p">,</span>
                      <span class="kc">None</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                                  <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">continuous</span><span class="p">,</span>
                      <span class="kc">None</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                                  <span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">categorical</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">indices</span><span class="p">])</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">return</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Christian Amesoeder, Michael Hagn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>